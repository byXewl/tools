import{o as W,R as H,w as O,l as s,y as t,q as E,J as G,G as L,H as h,O as I,z as J,I as u,C as b,A as Q,B as X,V as Y,U as Z,b as o,K as ee,v as n}from"./@vue-CpAqE2Pn.js";import{b as te,u as le}from"./vue-router-BdM7TbSB.js";import{$ as oe}from"./peerjs-y79QIrVN.js";import{_ as se}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./peerjs-js-binarypack-0qb93TeF.js";import"./webrtc-adapter-6eJpxPNa.js";import"./sdp-Cq9FPm4e.js";import"./file-saver-D_h_-nX0.js";const ne={class:"min-h-screen bg-slate-50 relative overflow-hidden font-sans selection:bg-orange-100"},ae={class:"relative z-10 max-w-4xl mx-auto px-6 py-12"},re={class:"flex flex-col items-center mb-10 text-center"},ie={class:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-xl border border-white/50 p-2 flex mb-8 max-w-md mx-auto"},de={class:"bg-white/70 backdrop-blur-xl rounded-3xl shadow-xl border border-white/50 p-6 md:p-10 min-h-[400px] flex flex-col items-center justify-center transition-all relative overflow-hidden"},ue={key:0,class:"w-full max-w-lg flex flex-col items-center"},ce={key:0,class:"w-full"},ve={key:1,class:"w-full flex flex-col items-center text-center space-y-6"},xe={class:"bg-white p-4 rounded-2xl shadow-sm border border-slate-100 flex items-center gap-4 w-full"},pe={class:"w-12 h-12 bg-orange-100 text-orange-600 rounded-lg flex items-center justify-center font-bold text-xl uppercase"},fe={class:"text-left flex-1 min-w-0"},me={class:"font-bold text-slate-800 truncate"},ge={class:"text-xs text-slate-500"},he={class:"w-full bg-slate-50 border border-slate-200 rounded-2xl p-6 relative"},be={class:"flex items-center justify-center gap-3 mb-4"},we={key:0,class:"animate-pulse h-10 w-32 bg-slate-200 rounded"},ye={key:1,class:"text-4xl font-mono font-black text-orange-600 tracking-wider select-all"},ke={class:"mt-4 flex items-center justify-center gap-2 text-xs text-slate-400"},_e={key:1,class:"w-full max-w-lg flex flex-col items-center"},Ce={key:0,class:"w-full space-y-6"},Be={class:"flex justify-center gap-2"},Me=["disabled"],ze={key:1,class:"w-full text-center space-y-6"},je={class:"w-20 h-20 bg-green-100 text-green-600 rounded-full mx-auto flex items-center justify-center mb-2"},Re={key:0,xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2",class:"animate-bounce"},Le={key:1,xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Se={class:"text-xl font-bold text-slate-800"},Fe={key:0,class:"text-slate-500 text-sm mt-1"},Ue={class:"w-full bg-slate-100 rounded-full h-4 overflow-hidden relative"},Ve={class:"absolute inset-0 flex items-center justify-center text-[10px] font-bold text-slate-600 mix-blend-multiply"},Ie={__name:"FileWormhole",setup(Pe){const w=te(),P=le(),r=o("send"),i=o(null),v=o(null),f=o(null),C=o(""),x=o(""),B=o("idle"),p=o("ç­‰å¾…ç”Ÿæˆè¿æ¥ç ..."),m=o(!1),d=o(null),y=o([]),M=o(0),c=o(0),z=o("ç­‰å¾…å‘é€æ–¹..."),k=o(null),S=l=>{if(l===0)return"0 B";const e=1024,g=["B","KB","MB","GB"],a=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,a)).toFixed(2))+" "+g[a]},T=()=>Math.random().toString(36).substring(2,8).toUpperCase(),q=()=>{if(v.value)return;const l=T();v.value=new oe(l,{debug:2}),v.value.on("open",e=>{C.value=e,p.value="ç­‰å¾…å¯¹æ–¹è¿æ¥...",w.query.code&&r.value==="receive"&&(x.value=w.query.code,j())}),v.value.on("connection",e=>{F(e)}),v.value.on("error",e=>{console.error(e),p.value="è¿æ¥æœåŠ¡é”™è¯¯: "+e.type,m.value=!1})},F=l=>{f.value=l,B.value="connected",p.value="å·²è¿æ¥! å‡†å¤‡ä¼ è¾“...",m.value=!1,l.on("open",()=>{r.value==="send"&&i.value&&$()}),l.on("data",e=>{A(e)}),l.on("close",()=>{R(),alert("è¿æ¥å·²æ–­å¼€")})},D=l=>{const e=l.target.files[0];e&&(i.value=e)},N=l=>{const e=l.dataTransfer.files[0];e&&(i.value=e)},$=()=>{if(!f.value||!i.value)return;const l=f.value,e=i.value;p.value="æ­£åœ¨ä¼ è¾“ä¸­...",l.send({type:"meta",name:e.name,size:e.size,mime:e.type});const g=16*1024;let a=0;const U=new FileReader;U.onload=_=>{l.send({type:"chunk",data:_.target.result}),a+=_.target.result.byteLength,a<e.size?V():(l.send({type:"end"}),p.value="ä¼ è¾“å®Œæˆ!")};const V=()=>{const _=e.slice(a,a+g);U.readAsArrayBuffer(_)};V()},j=()=>{if(!x.value)return;m.value=!0;const l=v.value.connect(x.value.toUpperCase());F(l)},A=l=>{l.type==="meta"?(d.value=l,y.value=[],M.value=0,c.value=0,z.value="æ­£åœ¨æ¥æ”¶æ–‡ä»¶..."):l.type==="chunk"?(y.value.push(l.data),M.value+=l.data.byteLength,d.value&&(c.value=Math.floor(M.value/d.value.size*100))):l.type==="end"&&(c.value=100,z.value="æ¥æ”¶å®Œæˆ!",k.value=new Blob(y.value,{type:d.value.mime}))},K=()=>{if(!k.value||!d.value)return;const l=URL.createObjectURL(k.value),e=document.createElement("a");e.href=l,e.download=d.value.name,document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(l)},R=()=>{i.value=null,f.value=null,B.value="idle",y.value=[],k.value=null,c.value=0,d.value=null,p.value="ç­‰å¾…å¯¹æ–¹è¿æ¥..."};return W(()=>{q(),w.query.code&&(r.value="receive",x.value=w.query.code)}),H(()=>{v.value&&v.value.destroy()}),O(r,l=>{l==="send"&&P.replace({query:{}})}),(l,e)=>{const g=ee("RouterLink");return n(),s("div",ne,[e[17]||(e[17]=t("div",{class:"absolute inset-0 z-0 opacity-[0.4]",style:{"background-image":"radial-gradient(#cbd5e1 1px, transparent 1px)","background-size":"32px 32px"}},null,-1)),e[18]||(e[18]=t("div",{class:"absolute top-0 right-[-10%] w-[500px] h-[500px] bg-orange-300 rounded-full mix-blend-multiply filter blur-[128px] opacity-40 animate-blob"},null,-1)),e[19]||(e[19]=t("div",{class:"absolute bottom-[-10%] left-[-10%] w-[500px] h-[500px] bg-yellow-300 rounded-full mix-blend-multiply filter blur-[128px] opacity-40 animate-blob animation-delay-2000"},null,-1)),t("div",ae,[t("div",re,[E(g,{to:"/",class:"text-sm font-medium text-slate-500 hover:text-orange-600 mb-4 inline-flex items-center gap-1 transition-colors"},{default:G(()=>[...e[4]||(e[4]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"m15 18-6-6 6-6"})],-1),h(" è¿”å›é¦–é¡µ ",-1)])]),_:1}),e[5]||(e[5]=t("h1",{class:"text-3xl md:text-4xl font-extrabold text-slate-900 mb-3"},[t("span",{class:"text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-amber-600"},"P2P æé€Ÿä¼ é€é—¨")],-1)),e[6]||(e[6]=t("p",{class:"text-slate-600 max-w-2xl"}," å‘Šåˆ«ç½‘ç›˜é™é€Ÿä¸ä¸Šä¼ ã€‚åŸºäº WebRTC æŠ€æœ¯ï¼Œå»ºç«‹æµè§ˆå™¨é—´çš„åŠ å¯†ç›´è¿é€šé“ï¼Œä¸é™é€Ÿã€ä¸é™å¤§å°ã€æ— æœåŠ¡å™¨å­˜å‚¨ã€‚ ",-1))]),t("div",ie,[t("button",{onClick:e[0]||(e[0]=a=>r.value="send"),class:L(["flex-1 py-2.5 rounded-xl text-sm font-bold transition-all flex items-center justify-center gap-2",r.value==="send"?"bg-orange-500 text-white shadow-lg shadow-orange-500/30":"text-slate-500 hover:bg-slate-100"])},[...e[7]||(e[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M22 2L11 13"}),t("path",{d:"M22 2l-7 20-4-9-9-4 20-7z"})],-1),h(" æˆ‘è¦å‘é€ ",-1)])],2),t("button",{onClick:e[1]||(e[1]=a=>r.value="receive"),class:L(["flex-1 py-2.5 rounded-xl text-sm font-bold transition-all flex items-center justify-center gap-2",r.value==="receive"?"bg-orange-500 text-white shadow-lg shadow-orange-500/30":"text-slate-500 hover:bg-slate-100"])},[...e[8]||(e[8]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),t("polyline",{points:"7 10 12 15 17 10"}),t("line",{x1:"12",x2:"12",y1:"15",y2:"3"})],-1),h(" æˆ‘è¦æ¥æ”¶ ",-1)])],2)]),t("div",de,[r.value==="send"?(n(),s("div",ue,[i.value?(n(),s("div",ve,[t("div",xe,[t("div",pe,u(i.value.name.split(".").pop().substring(0,3)),1),t("div",fe,[t("div",me,u(i.value.name),1),t("div",ge,u(S(i.value.size)),1)]),t("button",{onClick:R,class:"text-slate-400 hover:text-red-500 transition-colors p-2"},[...e[10]||(e[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),t("div",he,[e[11]||(e[11]=t("h3",{class:"text-slate-500 text-sm font-medium mb-3"}," å°†æ­¤å–ä»¶ç å‘Šè¯‰å¯¹æ–¹ ",-1)),t("div",be,[C.value?(n(),s("div",ye,u(C.value),1)):(n(),s("div",we))]),t("div",ke,[t("span",{class:L(["w-2 h-2 rounded-full",B.value==="connected"?"bg-green-500 animate-pulse":"bg-yellow-400"])},null,2),h(" "+u(p.value),1)])]),e[12]||(e[12]=t("div",{class:"text-xs text-slate-400 max-w-xl"}," âš ï¸ è¯·ä¿æŒæ­¤é¡µé¢å¼€å¯ï¼Œç›´åˆ°å¯¹æ–¹ä¸‹è½½å®Œæˆã€‚å…³é—­é¡µé¢å°†æ–­å¼€è¿æ¥ã€‚ ",-1))])):(n(),s("div",ce,[t("label",{class:"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-orange-200 rounded-2xl cursor-pointer bg-orange-50/30 hover:bg-orange-50 hover:border-orange-400 transition-all group",onDragover:e[2]||(e[2]=I(()=>{},["prevent"])),onDrop:I(N,["prevent"])},[e[9]||(e[9]=J('<div class="flex flex-col items-center justify-center pt-5 pb-6" data-v-acc43d33><div class="w-16 h-16 bg-white rounded-full shadow-sm flex items-center justify-center mb-4 group-hover:scale-110 transition-transform" data-v-acc43d33><svg class="w-8 h-8 text-orange-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16" data-v-acc43d33><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2" data-v-acc43d33></path></svg></div><p class="mb-2 text-sm text-slate-600 font-bold" data-v-acc43d33>ç‚¹å‡»ä¸Šä¼  æˆ– æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ</p><p class="text-xs text-slate-400" data-v-acc43d33>æ”¯æŒä»»æ„æ ¼å¼ï¼Œå¤§å°ä¸é™ (P2Pç›´è¿)</p></div>',1)),t("input",{type:"file",class:"hidden",onChange:D},null,32)],32)]))])):b("",!0),r.value==="receive"?(n(),s("div",_e,[f.value?(n(),s("div",ze,[t("div",je,[c.value<100?(n(),s("svg",Re,[...e[14]||(e[14]=[t("path",{d:"M12 17V3"},null,-1),t("path",{d:"m6 11 6 6 6-6"},null,-1),t("path",{d:"M19 21H5"},null,-1)])])):(n(),s("svg",Le,[...e[15]||(e[15]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])]))]),t("div",null,[t("h3",Se,u(z.value),1),d.value?(n(),s("p",Fe,u(d.value.name)+" ("+u(S(d.value.size))+") ",1)):b("",!0)]),t("div",Ue,[t("div",{class:"h-full bg-gradient-to-r from-orange-500 to-yellow-400 transition-all duration-300",style:Z({width:c.value+"%"})},null,4),t("div",Ve,u(c.value)+"% ",1)]),c.value===100?(n(),s("button",{key:0,onClick:K,class:"px-8 py-3 bg-green-500 text-white font-bold rounded-xl shadow-lg shadow-green-500/30 hover:bg-green-600 transition-all"}," ä¿å­˜æ–‡ä»¶ ")):b("",!0),c.value===100?(n(),s("button",{key:1,onClick:R,class:"block mx-auto mt-4 text-sm text-slate-400 hover:text-orange-500"}," æ¥æ”¶ä¸‹ä¸€ä¸ª ")):b("",!0)])):(n(),s("div",Ce,[e[13]||(e[13]=t("div",{class:"text-center"},[t("h3",{class:"text-lg font-bold text-slate-800"}," è¯·è¾“å…¥å–ä»¶ç  "),t("p",{class:"text-sm text-slate-500 mt-1"}," è¾“å…¥å¯¹æ–¹å±å¹•ä¸Šæ˜¾ç¤ºçš„ 6 ä½å·ç  ")],-1)),t("div",Be,[Q(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>x.value=a),type:"text",placeholder:"ä¾‹å¦‚: 9A3F12",maxlength:"8",class:"w-full max-w-xs text-center text-2xl font-mono font-bold py-3 border-2 border-slate-200 rounded-xl focus:border-orange-500 focus:outline-none focus:ring-4 focus:ring-orange-500/10 uppercase placeholder:text-slate-300",onKeyup:Y(j,["enter"])},null,544),[[X,x.value]])]),t("button",{onClick:j,disabled:!x.value||m.value,class:"w-full py-3.5 bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold rounded-xl shadow-lg shadow-orange-500/30 hover:shadow-orange-500/50 transition-all transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed"},u(m.value?"æ­£åœ¨è¿æ¥...":"ç«‹å³è¿æ¥æ¥æ”¶"),9,Me)]))])):b("",!0)]),e[16]||(e[16]=t("div",{class:"mt-8 bg-blue-50/80 backdrop-blur rounded-2xl p-5 border border-blue-100 text-sm text-blue-800"},[t("strong",{class:"flex items-center gap-2 mb-2"},[t("span",{class:"text-lg"},"ğŸ›¡ï¸"),h(" éšç§å£°æ˜ï¼š")]),t("p",{class:"leading-relaxed opacity-90"}," ä½¿ç”¨ WebRTC æŠ€æœ¯å®ç°ç‚¹å¯¹ç‚¹ä¼ è¾“ã€‚æ–‡ä»¶æ•°æ®ç›´æ¥ä»å‘é€ç«¯æµå‘æ¥æ”¶ç«¯ï¼Œä¸ç»è¿‡ä»»ä½•ä¸­é—´æœåŠ¡å™¨ï¼Œä¹Ÿä¸ä¼šè¢«å­˜å‚¨ã€‚è¯·ç¡®ä¿åŒæ–¹åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¦å…³é—­é¡µé¢ã€‚ ")],-1))])])}}},He=se(Ie,[["__scopeId","data-v-acc43d33"]]);export{He as default};
