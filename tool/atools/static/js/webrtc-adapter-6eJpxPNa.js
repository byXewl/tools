import{S as y,s as he}from"./sdp-Cq9FPm4e.js";let G=!0,z=!0;function g(e,r,o){const t=e.match(r);return t&&t.length>=o&&parseFloat(t[o],10)}function C(e,r,o){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.addEventListener;t.addEventListener=function(a,i){if(a!==r)return n.apply(this,arguments);const f=p=>{const c=o(p);c&&(i.handleEvent?i.handleEvent(c):i(c))};return this._eventMap=this._eventMap||{},this._eventMap[r]||(this._eventMap[r]=new Map),this._eventMap[r].set(i,f),n.apply(this,[a,f])};const s=t.removeEventListener;t.removeEventListener=function(a,i){if(a!==r||!this._eventMap||!this._eventMap[r])return s.apply(this,arguments);if(!this._eventMap[r].has(i))return s.apply(this,arguments);const f=this._eventMap[r].get(i);return this._eventMap[r].delete(i),this._eventMap[r].size===0&&delete this._eventMap[r],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[a,f])},Object.defineProperty(t,"on"+r,{get(){return this["_on"+r]},set(a){this["_on"+r]&&(this.removeEventListener(r,this["_on"+r]),delete this["_on"+r]),a&&this.addEventListener(r,this["_on"+r]=a)},enumerable:!0,configurable:!0})}function le(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(G=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Ce(e){return typeof e!="boolean"?new Error("Argument type: "+typeof e+". Please use a boolean."):(z=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function F(){if(typeof window=="object"){if(G)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function x(e,r){z&&console.warn(e+" is deprecated, please use "+r+" instead.")}function ge(e){const r={browser:null,version:null};if(typeof e>"u"||!e.navigator||!e.navigator.userAgent)return r.browser="Not a browser.",r;const{navigator:o}=e;if(o.userAgentData&&o.userAgentData.brands){const t=o.userAgentData.brands.find(n=>n.brand==="Chromium");if(t)return{browser:"chrome",version:parseInt(t.version,10)}}if(o.mozGetUserMedia)r.browser="firefox",r.version=parseInt(g(o.userAgent,/Firefox\/(\d+)\./,1));else if(o.webkitGetUserMedia||e.isSecureContext===!1&&e.webkitRTCPeerConnection)r.browser="chrome",r.version=parseInt(g(o.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(e.RTCPeerConnection&&o.userAgent.match(/AppleWebKit\/(\d+)\./))r.browser="safari",r.version=parseInt(g(o.userAgent,/AppleWebKit\/(\d+)\./,1)),r.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,r._safariVersion=g(o.userAgent,/Version\/(\d+(\.?\d+))/,1);else return r.browser="Not a supported browser.",r;return r}function O(e){return Object.prototype.toString.call(e)==="[object Object]"}function N(e){return O(e)?Object.keys(e).reduce(function(r,o){const t=O(e[o]),n=t?N(e[o]):e[o],s=t&&!Object.keys(n).length;return n===void 0||s?r:Object.assign(r,{[o]:n})},{}):e}function _(e,r,o){!r||o.has(r.id)||(o.set(r.id,r),Object.keys(r).forEach(t=>{t.endsWith("Id")?_(e,e.get(r[t]),o):t.endsWith("Ids")&&r[t].forEach(n=>{_(e,e.get(n),o)})}))}function L(e,r,o){const t=o?"outbound-rtp":"inbound-rtp",n=new Map;if(r===null)return n;const s=[];return e.forEach(a=>{a.type==="track"&&a.trackIdentifier===r.id&&s.push(a)}),s.forEach(a=>{e.forEach(i=>{i.type===t&&i.trackId===a.id&&_(e,i,n)})}),n}const j=F;function J(e,r){const o=e&&e.navigator;if(!o.mediaDevices)return;const t=function(i){if(typeof i!="object"||i.mandatory||i.optional)return i;const f={};return Object.keys(i).forEach(p=>{if(p==="require"||p==="advanced"||p==="mediaSource")return;const c=typeof i[p]=="object"?i[p]:{ideal:i[p]};c.exact!==void 0&&typeof c.exact=="number"&&(c.min=c.max=c.exact);const d=function(u,m){return u?u+m.charAt(0).toUpperCase()+m.slice(1):m==="deviceId"?"sourceId":m};if(c.ideal!==void 0){f.optional=f.optional||[];let u={};typeof c.ideal=="number"?(u[d("min",p)]=c.ideal,f.optional.push(u),u={},u[d("max",p)]=c.ideal,f.optional.push(u)):(u[d("",p)]=c.ideal,f.optional.push(u))}c.exact!==void 0&&typeof c.exact!="number"?(f.mandatory=f.mandatory||{},f.mandatory[d("",p)]=c.exact):["min","max"].forEach(u=>{c[u]!==void 0&&(f.mandatory=f.mandatory||{},f.mandatory[d(u,p)]=c[u])})}),i.advanced&&(f.optional=(f.optional||[]).concat(i.advanced)),f},n=function(i,f){if(r.version>=61)return f(i);if(i=JSON.parse(JSON.stringify(i)),i&&typeof i.audio=="object"){const p=function(c,d,u){d in c&&!(u in c)&&(c[u]=c[d],delete c[d])};i=JSON.parse(JSON.stringify(i)),p(i.audio,"autoGainControl","googAutoGainControl"),p(i.audio,"noiseSuppression","googNoiseSuppression"),i.audio=t(i.audio)}if(i&&typeof i.video=="object"){let p=i.video.facingMode;p=p&&(typeof p=="object"?p:{ideal:p});const c=r.version<66;if(p&&(p.exact==="user"||p.exact==="environment"||p.ideal==="user"||p.ideal==="environment")&&!(o.mediaDevices.getSupportedConstraints&&o.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete i.video.facingMode;let d;if(p.exact==="environment"||p.ideal==="environment"?d=["back","rear"]:(p.exact==="user"||p.ideal==="user")&&(d=["front"]),d)return o.mediaDevices.enumerateDevices().then(u=>{u=u.filter(h=>h.kind==="videoinput");let m=u.find(h=>d.some(l=>h.label.toLowerCase().includes(l)));return!m&&u.length&&d.includes("back")&&(m=u[u.length-1]),m&&(i.video.deviceId=p.exact?{exact:m.deviceId}:{ideal:m.deviceId}),i.video=t(i.video),j("chrome: "+JSON.stringify(i)),f(i)})}i.video=t(i.video)}return j("chrome: "+JSON.stringify(i)),f(i)},s=function(i){return r.version>=64?i:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[i.name]||i.name,message:i.message,constraint:i.constraint||i.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(i,f,p){n(i,c=>{o.webkitGetUserMedia(c,f,d=>{p&&p(s(d))})})};if(o.getUserMedia=a.bind(o),o.mediaDevices.getUserMedia){const i=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(f){return n(f,p=>i(p).then(c=>{if(p.audio&&!c.getAudioTracks().length||p.video&&!c.getVideoTracks().length)throw c.getTracks().forEach(d=>{d.stop()}),new DOMException("","NotFoundError");return c},c=>Promise.reject(s(c))))}}}function V(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function $(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(o){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=o)},enumerable:!0,configurable:!0});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let s;e.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(i=>i.track&&i.track.id===n.track.id):s={track:n.track};const a=new Event("track");a.track=n.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[t.stream],this.dispatchEvent(a)}),t.stream.getTracks().forEach(n=>{let s;e.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(i=>i.track&&i.track.id===n.id):s={track:n};const a=new Event("track");a.track=n,a.receiver=s,a.transceiver={receiver:s},a.streams=[t.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),r.apply(this,arguments)}}else C(e,"track",r=>(r.transceiver||Object.defineProperty(r,"transceiver",{value:{receiver:r.receiver}}),r))}function B(e){if(typeof e=="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const r=function(n,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=n.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:n}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(i,f){let p=n.apply(this,arguments);return p||(p=r(this,i),this._senders.push(p)),p};const s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(i){s.apply(this,arguments);const f=this._senders.indexOf(i);f!==-1&&this._senders.splice(f,1)}}const o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],o.apply(this,[s]),s.getTracks().forEach(a=>{this._senders.push(r(this,a))})};const t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],t.apply(this,[s]),s.getTracks().forEach(a=>{const i=this._senders.find(f=>f.track===a);i&&this._senders.splice(this._senders.indexOf(i),1)})}}else if(typeof e=="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const r=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const t=r.apply(this,[]);return t.forEach(n=>n._pc=this),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function K(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const o=e.RTCPeerConnection.prototype.getSenders;o&&(e.RTCPeerConnection.prototype.getSenders=function(){const s=o.apply(this,[]);return s.forEach(a=>a._pc=this),s});const t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){const s=t.apply(this,arguments);return s._pc=this,s}),e.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>L(a,s.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const o=e.RTCPeerConnection.prototype.getReceivers;o&&(e.RTCPeerConnection.prototype.getReceivers=function(){const n=o.apply(this,[]);return n.forEach(s=>s._pc=this),n}),C(e,"track",t=>(t.receiver._pc=t.srcElement,t)),e.RTCRtpReceiver.prototype.getStats=function(){const n=this;return this._pc.getStats().then(s=>L(s,n.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;const r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const t=arguments[0];let n,s,a;return this.getSenders().forEach(i=>{i.track===t&&(n?a=!0:n=i)}),this.getReceivers().forEach(i=>(i.track===t&&(s?a=!0:s=i),i.track===t)),a||n&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(this,arguments)}}function q(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(a,i){if(!i)return r.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const f=r.apply(this,arguments);return this._shimmedLocalStreams[i.id]?this._shimmedLocalStreams[i.id].indexOf(f)===-1&&this._shimmedLocalStreams[i.id].push(f):this._shimmedLocalStreams[i.id]=[i,f],f};const o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(p=>{if(this.getSenders().find(d=>d.track===p))throw new DOMException("Track already exists.","InvalidAccessError")});const i=this.getSenders();o.apply(this,arguments);const f=this.getSenders().filter(p=>i.indexOf(p)===-1);this._shimmedLocalStreams[a.id]=[a].concat(f)};const t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],t.apply(this,arguments)};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(i=>{const f=this._shimmedLocalStreams[i].indexOf(a);f!==-1&&this._shimmedLocalStreams[i].splice(f,1),this._shimmedLocalStreams[i].length===1&&delete this._shimmedLocalStreams[i]}),n.apply(this,arguments)}}function H(e,r){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&r.version>=65)return q(e);const o=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const c=o.apply(this);return this._reverseStreams=this._reverseStreams||{},c.map(d=>this._reverseStreams[d.id])};const t=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(c){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},c.getTracks().forEach(d=>{if(this.getSenders().find(m=>m.track===d))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[c.id]){const d=new e.MediaStream(c.getTracks());this._streams[c.id]=d,this._reverseStreams[d.id]=c,c=d}t.apply(this,[c])};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(c){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},n.apply(this,[this._streams[c.id]||c]),delete this._reverseStreams[this._streams[c.id]?this._streams[c.id].id:c.id],delete this._streams[c.id]},e.RTCPeerConnection.prototype.addTrack=function(c,d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const u=[].slice.call(arguments,1);if(u.length!==1||!u[0].getTracks().find(l=>l===c))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(l=>l.track===c))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const h=this._streams[d.id];if(h)h.addTrack(c),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const l=new e.MediaStream([c]);this._streams[d.id]=l,this._reverseStreams[l.id]=d,this.addStream(l)}return this.getSenders().find(l=>l.track===c)};function s(p,c){let d=c.sdp;return Object.keys(p._reverseStreams||[]).forEach(u=>{const m=p._reverseStreams[u],h=p._streams[m.id];d=d.replace(new RegExp(h.id,"g"),m.id)}),new RTCSessionDescription({type:c.type,sdp:d})}function a(p,c){let d=c.sdp;return Object.keys(p._reverseStreams||[]).forEach(u=>{const m=p._reverseStreams[u],h=p._streams[m.id];d=d.replace(new RegExp(m.id,"g"),h.id)}),new RTCSessionDescription({type:c.type,sdp:d})}["createOffer","createAnswer"].forEach(function(p){const c=e.RTCPeerConnection.prototype[p],d={[p](){const u=arguments;return arguments.length&&typeof arguments[0]=="function"?c.apply(this,[h=>{const l=s(this,h);u[0].apply(null,[l])},h=>{u[1]&&u[1].apply(null,h)},arguments[2]]):c.apply(this,arguments).then(h=>s(this,h))}};e.RTCPeerConnection.prototype[p]=d[p]});const i=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?i.apply(this,arguments):(arguments[0]=a(this,arguments[0]),i.apply(this,arguments))};const f=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const p=f.get.apply(this);return p.type===""?p:s(this,p)}}),e.RTCPeerConnection.prototype.removeTrack=function(c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!c._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(c._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let u;Object.keys(this._streams).forEach(m=>{this._streams[m].getTracks().find(l=>c.track===l)&&(u=this._streams[m])}),u&&(u.getTracks().length===1?this.removeStream(this._reverseStreams[u.id]):u.removeTrack(c.track),this.dispatchEvent(new Event("negotiationneeded")))}}function E(e,r){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const t=e.RTCPeerConnection.prototype[o],n={[o](){return arguments[0]=new(o==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}};e.RTCPeerConnection.prototype[o]=n[o]})}function Y(e,r){C(e,"negotiationneeded",o=>{const t=o.target;if(!((r.version<72||t.getConfiguration&&t.getConfiguration().sdpSemantics==="plan-b")&&t.signalingState!=="stable"))return o})}const A=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Y,shimAddTrackRemoveTrack:H,shimAddTrackRemoveTrackWithNative:q,shimGetSendersWithDtmf:B,shimGetUserMedia:J,shimMediaStream:V,shimOnTrack:$,shimPeerConnection:E,shimSenderReceiverGetStats:K},Symbol.toStringTag,{value:"Module"}));function Q(e,r){const o=e&&e.navigator,t=e&&e.MediaStreamTrack;if(o.getUserMedia=function(n,s,a){x("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),o.mediaDevices.getUserMedia(n).then(s,a)},!(r.version>55&&"autoGainControl"in o.mediaDevices.getSupportedConstraints())){const n=function(a,i,f){i in a&&!(f in a)&&(a[f]=a[i],delete a[i])},s=o.mediaDevices.getUserMedia.bind(o.mediaDevices);if(o.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),n(a.audio,"autoGainControl","mozAutoGainControl"),n(a.audio,"noiseSuppression","mozNoiseSuppression")),s(a)},t&&t.prototype.getSettings){const a=t.prototype.getSettings;t.prototype.getSettings=function(){const i=a.apply(this,arguments);return n(i,"mozAutoGainControl","autoGainControl"),n(i,"mozNoiseSuppression","noiseSuppression"),i}}if(t&&t.prototype.applyConstraints){const a=t.prototype.applyConstraints;t.prototype.applyConstraints=function(i){return this.kind==="audio"&&typeof i=="object"&&(i=JSON.parse(JSON.stringify(i)),n(i,"autoGainControl","mozAutoGainControl"),n(i,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[i])}}}}function ye(e,r){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(t){if(!(t&&t.video)){const n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return t.video===!0?t.video={mediaSource:r}:t.video.mediaSource=r,e.navigator.mediaDevices.getUserMedia(t)})}function X(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function k(e,r){if(typeof e!="object"||!(e.RTCPeerConnection||e.mozRTCPeerConnection))return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),r.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const s=e.RTCPeerConnection.prototype[n],a={[n](){return arguments[0]=new(n==="addIceCandidate"?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};e.RTCPeerConnection.prototype[n]=a[n]});const o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[s,a,i]=arguments;return t.apply(this,[s||null]).then(f=>{if(r.version<53&&!a)try{f.forEach(p=>{p.type=o[p.type]||p.type})}catch(p){if(p.name!=="TypeError")throw p;f.forEach((c,d)=>{f.set(d,Object.assign({},c,{type:o[c.type]||c.type}))})}return f}).then(a,i)}}function Z(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){const n=r.apply(this,[]);return n.forEach(s=>s._pc=this),n});const o=e.RTCPeerConnection.prototype.addTrack;o&&(e.RTCPeerConnection.prototype.addTrack=function(){const n=o.apply(this,arguments);return n._pc=this,n}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function W(e){if(!(typeof e=="object"&&e.RTCPeerConnection&&e.RTCRtpSender)||e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){const t=r.apply(this,[]);return t.forEach(n=>n._pc=this),t}),C(e,"track",o=>(o.receiver._pc=o.srcElement,o)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function w(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(o){x("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&o.getTracks().includes(t.track)&&this.removeTrack(t)})})}function ee(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function te(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.addTransceiver;r&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let t=arguments[1]&&arguments[1].sendEncodings;t===void 0&&(t=[]),t=[...t];const n=t.length>0;n&&t.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=r.apply(this,arguments);if(n){const{sender:a}=s,i=a.getParameters();(!("encodings"in i)||i.encodings.length===1&&Object.keys(i.encodings[0]).length===0)&&(i.encodings=t,a.sendEncodings=t,this.setParametersPromises.push(a.setParameters(i).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return s})}function re(e){if(!(typeof e=="object"&&e.RTCRtpSender))return;const r=e.RTCRtpSender.prototype.getParameters;r&&(e.RTCRtpSender.prototype.getParameters=function(){const t=r.apply(this,arguments);return"encodings"in t||(t.encodings=[].concat(this.sendEncodings||[{}])),t})}function ne(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}function ie(e){if(!(typeof e=="object"&&e.RTCPeerConnection))return;const r=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>r.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):r.apply(this,arguments)}}const I=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:te,shimCreateAnswer:ie,shimCreateOffer:ne,shimGetDisplayMedia:ye,shimGetParameters:re,shimGetUserMedia:Q,shimOnTrack:X,shimPeerConnection:k,shimRTCDataChannel:ee,shimReceiverGetStats:W,shimRemoveStream:w,shimSenderGetStats:Z},Symbol.toStringTag,{value:"Module"}));function oe(e){if(!(typeof e!="object"||!e.RTCPeerConnection)){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(t){this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getAudioTracks().forEach(n=>r.call(this,n,t)),t.getVideoTracks().forEach(n=>r.call(this,n,t))},e.RTCPeerConnection.prototype.addTrack=function(t,...n){return n&&n.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),r.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(o){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(o);if(t===-1)return;this._localStreams.splice(t,1);const n=o.getTracks();this.getSenders().forEach(s=>{n.includes(s.track)&&this.removeTrack(s)})})}}function se(e){if(!(typeof e!="object"||!e.RTCPeerConnection)&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(o){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=o),this.addEventListener("track",this._onaddstreampoly=t=>{t.streams.forEach(n=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(n))return;this._remoteStreams.push(n);const s=new Event("addstream");s.stream=n,this.dispatchEvent(s)})})}});const r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const t=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(n){n.streams.forEach(s=>{if(t._remoteStreams||(t._remoteStreams=[]),t._remoteStreams.indexOf(s)>=0)return;t._remoteStreams.push(s);const a=new Event("addstream");a.stream=s,t.dispatchEvent(a)})}),r.apply(t,arguments)}}}function ae(e){if(typeof e!="object"||!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,o=r.createOffer,t=r.createAnswer,n=r.setLocalDescription,s=r.setRemoteDescription,a=r.addIceCandidate;r.createOffer=function(p,c){const d=arguments.length>=2?arguments[2]:arguments[0],u=o.apply(this,[d]);return c?(u.then(p,c),Promise.resolve()):u},r.createAnswer=function(p,c){const d=arguments.length>=2?arguments[2]:arguments[0],u=t.apply(this,[d]);return c?(u.then(p,c),Promise.resolve()):u};let i=function(f,p,c){const d=n.apply(this,[f]);return c?(d.then(p,c),Promise.resolve()):d};r.setLocalDescription=i,i=function(f,p,c){const d=s.apply(this,[f]);return c?(d.then(p,c),Promise.resolve()):d},r.setRemoteDescription=i,i=function(f,p,c){const d=a.apply(this,[f]);return c?(d.then(p,c),Promise.resolve()):d},r.addIceCandidate=i}function ce(e){const r=e&&e.navigator;if(r.mediaDevices&&r.mediaDevices.getUserMedia){const o=r.mediaDevices,t=o.getUserMedia.bind(o);r.mediaDevices.getUserMedia=n=>t(pe(n))}!r.getUserMedia&&r.mediaDevices&&r.mediaDevices.getUserMedia&&(r.getUserMedia=(function(t,n,s){r.mediaDevices.getUserMedia(t).then(n,s)}).bind(r))}function pe(e){return e&&e.video!==void 0?Object.assign({},e,{video:N(e.video)}):e}function fe(e){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection;e.RTCPeerConnection=function(t,n){if(t&&t.iceServers){const s=[];for(let a=0;a<t.iceServers.length;a++){let i=t.iceServers[a];i.urls===void 0&&i.url?(x("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,s.push(i)):s.push(t.iceServers[a])}t.iceServers=s}return new r(t,n)},e.RTCPeerConnection.prototype=r.prototype,"generateCertificate"in r&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get(){return r.generateCertificate}})}function de(e){typeof e=="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function ue(e){const r=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(t){if(t){typeof t.offerToReceiveAudio<"u"&&(t.offerToReceiveAudio=!!t.offerToReceiveAudio);const n=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");t.offerToReceiveAudio===!1&&n?n.direction==="sendrecv"?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":n.direction==="recvonly"&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):t.offerToReceiveAudio===!0&&!n&&this.addTransceiver("audio",{direction:"recvonly"}),typeof t.offerToReceiveVideo<"u"&&(t.offerToReceiveVideo=!!t.offerToReceiveVideo);const s=this.getTransceivers().find(a=>a.receiver.track.kind==="video");t.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):t.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return r.apply(this,arguments)}}function me(e){typeof e!="object"||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}const U=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:me,shimCallbacksAPI:ae,shimConstraints:pe,shimCreateOfferLegacy:ue,shimGetUserMedia:ce,shimLocalStreamsAPI:oe,shimRTCIceServerUrls:fe,shimRemoteStreamsAPI:se,shimTrackEventTransceiver:de},Symbol.toStringTag,{value:"Module"}));function S(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const r=e.RTCIceCandidate;e.RTCIceCandidate=function(t){if(typeof t=="object"&&t.candidate&&t.candidate.indexOf("a=")===0&&(t=JSON.parse(JSON.stringify(t)),t.candidate=t.candidate.substring(2)),t.candidate&&t.candidate.length){const n=new r(t),s=y.parseCandidate(t.candidate);for(const a in s)a in n||Object.defineProperty(n,a,{value:s[a]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new r(t)},e.RTCIceCandidate.prototype=r.prototype,C(e,"icecandidate",o=>(o.candidate&&Object.defineProperty(o,"candidate",{value:new e.RTCIceCandidate(o.candidate),writable:"false"}),o))}function b(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||C(e,"icecandidate",r=>{if(r.candidate){const o=y.parseCandidate(r.candidate.candidate);o.type==="relay"&&(r.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[o.priority>>24])}return r})}function v(e,r){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const o=function(i){if(!i||!i.sdp)return!1;const f=y.splitSections(i.sdp);return f.shift(),f.some(p=>{const c=y.parseMLine(p);return c&&c.kind==="application"&&c.protocol.indexOf("SCTP")!==-1})},t=function(i){const f=i.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(f===null||f.length<2)return-1;const p=parseInt(f[1],10);return p!==p?-1:p},n=function(i){let f=65536;return r.browser==="firefox"&&(r.version<57?i===-1?f=16384:f=2147483637:r.version<60?f=r.version===57?65535:65536:f=2147483637),f},s=function(i,f){let p=65536;r.browser==="firefox"&&r.version===57&&(p=65535);const c=y.matchPrefix(i.sdp,"a=max-message-size:");return c.length>0?p=parseInt(c[0].substring(19),10):r.browser==="firefox"&&f!==-1&&(p=2147483637),p},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,r.browser==="chrome"&&r.version>=76){const{sdpSemantics:f}=this.getConfiguration();f==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(o(arguments[0])){const f=t(arguments[0]),p=n(f),c=s(arguments[0],f);let d;p===0&&c===0?d=Number.POSITIVE_INFINITY:p===0||c===0?d=Math.max(p,c):d=Math.min(p,c);const u={};Object.defineProperty(u,"maxMessageSize",{get(){return d}}),this._sctp=u}return a.apply(this,arguments)}}function T(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function r(t,n){const s=t.send;t.send=function(){const i=arguments[0],f=i.length||i.size||i.byteLength;if(t.readyState==="open"&&n.sctp&&f>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return s.apply(t,arguments)}}const o=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const n=o.apply(this,arguments);return r(n,this),n},C(e,"datachannel",t=>(r(t.channel,t.target),t))}function D(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const r=e.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(o){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),o&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=o)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(o=>{const t=r[o];r[o]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=n=>{const s=n.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const a=new Event("connectionstatechange",n);s.dispatchEvent(a)}return n},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}})}function M(e,r){if(!e.RTCPeerConnection||r.browser==="chrome"&&r.version>=71||r.browser==="safari"&&r._safariVersion>=13.1)return;const o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(n){if(n&&n.sdp&&n.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=n.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);e.RTCSessionDescription&&n instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:n.type,sdp:s}):n.sdp=s}return o.apply(this,arguments)}}function R(e,r){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const o=e.RTCPeerConnection.prototype.addIceCandidate;!o||o.length===0||(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(r.browser==="chrome"&&r.version<78||r.browser==="firefox"&&r.version<68||r.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():o.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function P(e,r){if(!(e.RTCPeerConnection&&e.RTCPeerConnection.prototype))return;const o=e.RTCPeerConnection.prototype.setLocalDescription;!o||o.length===0||(e.RTCPeerConnection.prototype.setLocalDescription=function(){let n=arguments[0]||{};if(typeof n!="object"||n.type&&n.sdp)return o.apply(this,arguments);if(n={type:n.type,sdp:n.sdp},!n.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":n.type="offer";break;default:n.type="answer";break}return n.sdp||n.type!=="offer"&&n.type!=="answer"?o.apply(this,[n]):(n.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>o.apply(this,[a]))})}const Se=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:M,shimAddIceCandidateNullOrEmpty:R,shimConnectionState:D,shimMaxMessageSize:v,shimParameterlessSetLocalDescription:P,shimRTCIceCandidate:S,shimRTCIceCandidateRelayProtocol:b,shimSendThrowTypeError:T},Symbol.toStringTag,{value:"Module"}));function ve({window:e}={},r={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const o=F,t=ge(e),n={browserDetails:t,commonShim:Se,extractVersion:g,disableLog:le,disableWarnings:Ce,sdp:he};switch(t.browser){case"chrome":if(!A||!E||!r.shimChrome)return o("Chrome shim is not included in this adapter release."),n;if(t.version===null)return o("Chrome shim can not determine version, not shimming."),n;o("adapter.js shimming chrome."),n.browserShim=A,R(e,t),P(e),J(e,t),V(e),E(e,t),$(e),H(e,t),B(e),K(e),Y(e,t),S(e),b(e),D(e),v(e,t),T(e),M(e,t);break;case"firefox":if(!I||!k||!r.shimFirefox)return o("Firefox shim is not included in this adapter release."),n;o("adapter.js shimming firefox."),n.browserShim=I,R(e,t),P(e),Q(e,t),k(e,t),X(e),w(e),Z(e),W(e),ee(e),te(e),re(e),ne(e),ie(e),S(e),D(e),v(e,t),T(e);break;case"safari":if(!U||!r.shimSafari)return o("Safari shim is not included in this adapter release."),n;o("adapter.js shimming safari."),n.browserShim=U,R(e,t),P(e),fe(e),ue(e),ae(e),oe(e),se(e),de(e),ce(e),me(e),S(e),b(e),v(e,t),T(e),M(e,t);break;default:o("Unsupported browser!");break}return n}const Re=ve({window:typeof window>"u"?void 0:window});export{Re as a};
