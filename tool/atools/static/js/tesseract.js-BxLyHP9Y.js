import{g as je}from"./file-saver-D_h_-nX0.js";import{r as Ke}from"./regenerator-runtime-CZYGiTJq.js";import{c as He}from"./jszip-DXViFxuE.js";var P,se;function ee(){return se||(se=1,P=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`),P}var U,ie;function Te(){if(ie)return U;ie=1;const t=ee();let e=0;return U=({id:r,action:a,payload:n={}})=>{let i=r;return typeof i>"u"&&(i=t("Job",e),e+=1),{id:i,action:a,payload:n}},U}var O={},ce;function re(){if(ce)return O;ce=1;let t=!1;return O.logging=t,O.setLogging=e=>{t=e},O.log=(...e)=>t?console.log.apply(this,e):null,O}var $,ue;function Je(){if(ue)return $;ue=1;const t=Te(),{log:e}=re(),r=ee();let a=0;return $=()=>{const n=r("Scheduler",a),i={},f={};let R=[];a+=1;const b=()=>R.length,v=()=>Object.keys(i).length,E=()=>{if(R.length!==0){const c=Object.keys(i);for(let d=0;d<c.length;d+=1)if(typeof f[c[d]]>"u"){R[0](i[c[d]]);break}}},y=(c,d)=>new Promise((q,T)=>{const l=t({action:c,payload:d});R.push(async S=>{R.shift(),f[S.id]=l;try{q(await S[c].apply(this,[...d,l.id]))}catch(k){T(k)}finally{delete f[S.id],E()}}),e(`[${n}]: Add ${l.id} to JobQueue`),e(`[${n}]: JobQueue length=${R.length}`),E()});return{addWorker:c=>(i[c.id]=c,e(`[${n}]: Add ${c.id}`),e(`[${n}]: Number of workers=${v()}`),E(),c.id),addJob:async(c,...d)=>{if(v()===0)throw Error(`[${n}]: You need to have at least one worker before adding jobs`);return y(c,d)},terminate:async()=>{Object.keys(i).forEach(async c=>{await i[c].terminate()}),R=[]},getQueueLen:b,getNumWorkers:v}},$}var D,le;function Ye(){return le||(le=1,D=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof He=="function"&&(e.type="node"),typeof t>"u"?e:e[t]}),D}var W,de;function Ve(){if(de)return W;de=1;const e=Ye()("type")==="browser"?r=>new URL(r,window.location.href).href:r=>r;return W=r=>{const a={...r};return["corePath","workerPath","langPath"].forEach(n=>{r[n]&&(a[n]=e(a[n]))}),a},W}var B,fe;function ke(){return fe||(fe=1,B={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),B}const Ze="6.0.1",xe={version:Ze};var F,ge;function Qe(){return ge||(ge=1,F={workerBlobURL:!0,logger:()=>{}}),F}var G,pe;function Xe(){if(pe)return G;pe=1;const t=xe.version;return G={...Qe(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${t}/dist/worker.min.js`},G}var z,he;function er(){return he||(he=1,z=({workerPath:t,workerBlobURL:e})=>{let r;if(Blob&&URL&&e){const a=new Blob([`importScripts("${t}");`],{type:"application/javascript"});r=new Worker(URL.createObjectURL(a))}else r=new Worker(t);return r}),z}var j,Le;function rr(){return Le||(Le=1,j=t=>{t.terminate()}),j}var K,Re;function tr(){return Re||(Re=1,K=(t,e)=>{t.onmessage=({data:r})=>{e(r)}}),K}var H,Se;function nr(){return Se||(Se=1,H=async(t,e)=>{t.postMessage(e)}),H}var J,me;function or(){if(me)return J;me=1;const t=r=>new Promise((a,n)=>{const i=new FileReader;i.onload=()=>{a(i.result)},i.onerror=({target:{error:{code:f}}})=>{n(Error(`File could not be read! Code=${f}`))},i.readAsArrayBuffer(r)}),e=async r=>{let a=r;if(typeof r>"u")return"undefined";if(typeof r=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(r)?a=atob(r.split(",")[1]).split("").map(n=>n.charCodeAt(0)):a=await(await fetch(r)).arrayBuffer();else if(typeof HTMLElement<"u"&&r instanceof HTMLElement)r.tagName==="IMG"&&(a=await e(r.src)),r.tagName==="VIDEO"&&(a=await e(r.poster)),r.tagName==="CANVAS"&&await new Promise(n=>{r.toBlob(async i=>{a=await t(i),n()})});else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas){const n=await r.convertToBlob();a=await t(n)}else(r instanceof File||r instanceof Blob)&&(a=await t(r));return new Uint8Array(a)};return J=e,J}var Y,ve;function ar(){if(ve)return Y;ve=1;const t=Xe(),e=er(),r=rr(),a=tr(),n=nr(),i=or();return Y={defaultOptions:t,spawnWorker:e,terminateWorker:r,onMessage:a,send:n,loadImage:i},Y}var V,we;function be(){if(we)return V;we=1;const t=Ve(),e=Te(),{log:r}=re(),a=ee(),n=ke(),{defaultOptions:i,spawnWorker:f,terminateWorker:R,onMessage:b,loadImage:v,send:E}=ar();let y=0;return V=async(w="eng",A=n.LSTM_ONLY,te={},c={})=>{const d=a("Worker",y),{logger:q,errorHandler:T,...l}=t({...i,...te}),S={},k=typeof w=="string"?w.split("+"):w;let _=A,ne=c;const I=[n.DEFAULT,n.LSTM_ONLY].includes(A)&&!l.legacyCore;let M,oe;const qe=new Promise((o,s)=>{oe=o,M=s}),_e=o=>{M(o.message)};let m=f(l);m.onerror=_e,y+=1;const h=({id:o,action:s,payload:u})=>new Promise((g,p)=>{r(`[${d}]: Start ${o}, action=${s}`);const L=`${s}-${o}`;S[L]={resolve:g,reject:p},E(m,{workerId:d,jobId:o,action:s,payload:u})}),Ie=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),Me=o=>h(e({id:o,action:"load",payload:{options:{lstmOnly:I,corePath:l.corePath,logging:l.logging}}})),Ne=(o,s,u)=>h(e({id:u,action:"FS",payload:{method:"writeFile",args:[o,s]}})),Ce=(o,s)=>h(e({id:s,action:"FS",payload:{method:"readFile",args:[o,{encoding:"utf8"}]}})),Pe=(o,s)=>h(e({id:s,action:"FS",payload:{method:"unlink",args:[o]}})),Ue=(o,s,u)=>h(e({id:u,action:"FS",payload:{method:o,args:s}})),ae=(o,s)=>h(e({id:s,action:"loadLanguage",payload:{langs:o,options:{langPath:l.langPath,dataPath:l.dataPath,cachePath:l.cachePath,cacheMethod:l.cacheMethod,gzip:l.gzip,lstmOnly:[n.DEFAULT,n.LSTM_ONLY].includes(_)&&!l.legacyLang}}})),N=(o,s,u,g)=>h(e({id:g,action:"initialize",payload:{langs:o,oem:s,config:u}})),$e=(o="eng",s,u,g)=>{if(I&&[n.TESSERACT_ONLY,n.TESSERACT_LSTM_COMBINED].includes(s))throw Error("Legacy model requested but code missing.");const p=s||_;_=p;const L=u||ne;ne=L;const C=(typeof o=="string"?o.split("+"):o).filter(ze=>!k.includes(ze));return k.push(...C),C.length>0?ae(C,g).then(()=>N(o,p,L,g)):N(o,p,L,g)},De=(o={},s)=>h(e({id:s,action:"setParameters",payload:{params:o}})),We=async(o,s={},u={text:!0},g)=>h(e({id:g,action:"recognize",payload:{image:await v(o),options:s,output:u}})),Be=async(o,s)=>{if(I)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return h(e({id:s,action:"detect",payload:{image:await v(o)}}))},Fe=async()=>(m!==null&&(R(m),m=null),Promise.resolve());b(m,({workerId:o,jobId:s,status:u,action:g,data:p})=>{const L=`${g}-${s}`;if(u==="resolve")r(`[${o}]: Complete ${s}`),S[L].resolve({jobId:s,data:p}),delete S[L];else if(u==="reject")if(S[L].reject(p),delete S[L],g==="load"&&M(p),T)T(p);else throw Error(p);else u==="progress"&&q({...p,userJobId:s})});const Ge={id:d,worker:m,load:Ie,writeText:Ne,readText:Ce,removeFile:Pe,FS:Ue,reinitialize:$e,setParameters:De,recognize:We,detect:Be,terminate:Fe};return Me().then(()=>ae(w)).then(()=>N(w,A,c)).then(()=>oe(Ge)).catch(()=>{}),qe},V}var Z,Ee;function sr(){if(Ee)return Z;Ee=1;const t=be();return Z={recognize:async(a,n,i)=>{const f=await t(n,1,i);return f.recognize(a).finally(async()=>{await f.terminate()})},detect:async(a,n)=>{const i=await t("osd",0,n);return i.detect(a).finally(async()=>{await i.terminate()})}},Z}var x,Oe;function ir(){return Oe||(Oe=1,x={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),x}var Q,ye;function cr(){return ye||(ye=1,Q={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Q}var X,Ae;function ur(){if(Ae)return X;Ae=1,Ke();const t=Je(),e=be(),r=sr(),a=ir(),n=ke(),i=cr(),{setLogging:f}=re();return X={languages:a,OEM:n,PSM:i,createScheduler:t,createWorker:e,setLogging:f,...r},X}var lr=ur();const hr=je(lr);export{hr as T,lr as s};
