import{l as g,y as l,q as S,J as N,C as I,H as _,F as X,D as Y,I as y,A as $,B as G,z as O,K as W,b as n,v as p,G as q}from"./@vue-CpAqE2Pn.js";import{_ as H}from"./FileUploader-DU1r4fqN.js";import{F as J}from"./file-saver-D_h_-nX0.js";import{T as U}from"./tesseract.js-BxLyHP9Y.js";import{_ as K}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./regenerator-runtime-CZYGiTJq.js";import"./jszip-DXViFxuE.js";const Q={class:"min-h-screen bg-slate-50 relative overflow-hidden font-sans selection:bg-orange-100"},Z={class:"relative z-10 max-w-6xl mx-auto px-6 py-12"},ee={class:"flex flex-col items-center mb-10 text-center"},te={class:"grid lg:grid-cols-12 gap-8"},le={class:"lg:col-span-8 space-y-4"},ae={class:"bg-white/70 backdrop-blur-xl rounded-3xl shadow-xl border border-white/50 p-1 md:p-2 min-h-[600px] flex flex-col transition-all relative"},oe={key:0,class:"flex-1 flex items-center justify-center p-8"},se={key:1,class:"relative w-full h-full bg-slate-100 rounded-2xl overflow-hidden flex items-center justify-center select-none group cursor-crosshair"},ne={key:2,class:"absolute bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-2 p-2 bg-white/90 backdrop-blur shadow-lg border border-slate-200 rounded-2xl z-20"},re={class:"lg:col-span-4 space-y-6"},ie={class:"bg-white/80 backdrop-blur-xl rounded-3xl shadow-xl border border-white/50 p-6"},de={class:"grid grid-cols-3 gap-3 mb-6"},ue=["onClick"],ce={class:"text-xl"},ge={class:"text-xs font-bold"},pe={key:0,class:"mb-2"},ve={class:"flex justify-between mb-2"},be={class:"text-xs font-mono bg-slate-100 px-2 rounded"},xe=["min","max"],he={class:"bg-gradient-to-br from-amber-50 to-orange-50 backdrop-blur-xl rounded-3xl shadow-lg border border-orange-100 p-6 relative overflow-hidden"},me=["disabled"],fe={key:0,class:"animate-spin"},we={key:1},ye=["disabled"],ke={__name:"ImageRedactor",setup(_e){const r=n(null),u=n(null),k=n(null),c=n(null),x=n([]),m=n(!1),s=n({x:0,y:0}),v=n("blur"),f=n(15),w=n(!1),j=[{value:"blur",label:"é«˜æ–¯æ¨¡ç³Š",icon:"ğŸ’§"},{value:"pixelate",label:"é©¬èµ›å…‹",icon:"ğŸ§±"},{value:"solid",label:"çº¯é»‘è¦†ç›–",icon:"â¬›"}],z=t=>{if(!t||t.length===0)return;r.value=t[0];const e=new FileReader;e.onload=o=>{const a=new Image;a.onload=()=>{c.value=a,E()},a.src=o.target.result},e.readAsDataURL(t[0])},B=()=>{r.value=null,c.value=null,x.value=[]},E=()=>{if(!u.value||!c.value)return;const t=u.value,e=c.value;t.width=e.width,t.height=e.height,k.value=t.getContext("2d",{willReadFrequently:!0}),h()},h=()=>{if(!k.value||!c.value)return;const t=k.value,e=u.value.width,o=u.value.height;if(t.filter="none",t.clearRect(0,0,e,o),t.drawImage(c.value,0,0),x.value.forEach(a=>{D(t,a)}),m.value){const a=M();t.strokeStyle="#f97316",t.lineWidth=2,t.setLineDash([5,5]),t.strokeRect(a.x,a.y,a.w,a.h),t.setLineDash([]),t.fillStyle="rgba(249, 115, 22, 0.2)",t.fillRect(a.x,a.y,a.w,a.h)}},D=(t,e)=>{if(t.save(),t.beginPath(),t.rect(e.x,e.y,e.w,e.h),t.clip(),e.type==="solid")t.fillStyle="#000000",t.fillRect(e.x,e.y,e.w,e.h);else if(e.type==="blur")t.filter=`blur(${e.intensity}px)`,t.drawImage(c.value,0,0);else if(e.type==="pixelate"){const o=e.intensity/100,a=Math.max(1,Math.floor(e.w*o)),i=Math.max(1,Math.floor(e.h*o));t.imageSmoothingEnabled=!1;const d=document.createElement("canvas");d.width=a,d.height=i,d.getContext("2d").drawImage(c.value,e.x,e.y,e.w,e.h,0,0,a,i),t.drawImage(d,0,0,a,i,e.x,e.y,e.w,e.h),t.imageSmoothingEnabled=!0}t.restore(),t.filter="none"},C=t=>{const e=u.value,o=e.getBoundingClientRect(),a=e.width/o.width,i=e.height/o.height;return{x:(t.clientX-o.left)*a,y:(t.clientY-o.top)*i}},F=t=>{r.value&&(m.value=!0,s.value=C(t))},P=t=>{if(!m.value)return;const e=C(t);h(),s.value.currentX=e.x,s.value.currentY=e.y},R=t=>{if(!m.value)return;m.value=!1;const e=M();e.w>5&&e.h>5&&x.value.push({...e,type:v.value,intensity:f.value}),h()},M=()=>{const t=s.value.currentX||s.value.x,e=s.value.currentY||s.value.y;return{x:Math.min(s.value.x,t),y:Math.min(s.value.y,e),w:Math.abs(t-s.value.x),h:Math.abs(e-s.value.y)}},V=()=>{x.value.pop(),h()},A=()=>{x.value=[],h()},L=async()=>{var t;if(r.value){w.value=!0;try{const e=await U.createWorker("eng+chi_sim"),o=await e.recognize(r.value);console.log("OCR Result:",o);const a=((t=o.data)==null?void 0:t.words)||[];a.length===0?alert("æœªè¯†åˆ«åˆ°æ¸…æ™°çš„æ–‡å­—åŒºåŸŸï¼Œè¯·å°è¯•è°ƒæ•´å›¾ç‰‡æ¸…æ™°åº¦ã€‚"):(a.forEach(i=>{if(i.confidence<60)return;const d=4,b=i.bbox;x.value.push({x:b.x0-d,y:b.y0-d,w:b.x1-b.x0+d*2,h:b.y1-b.y0+d*2,type:v.value,intensity:f.value})}),h()),await e.terminate()}catch(e){console.error("OCR Error:",e),alert(`è¯†åˆ«å¤±è´¥: ${e.message||"è¯·æ£€æŸ¥ç½‘ç»œæ˜¯å¦èƒ½è®¿é—® Github Pages (Tesseract éœ€è¦ä¸‹è½½è¯­è¨€åŒ…)"}`)}finally{w.value=!1}}},T=()=>{u.value&&u.value.toBlob(t=>{J.saveAs(t,`redacted_${Date.now()}.png`)})};return(t,e)=>{const o=W("RouterLink");return p(),g("div",Q,[e[14]||(e[14]=l("div",{class:"absolute inset-0 z-0 opacity-[0.4]",style:{"background-image":"radial-gradient(#cbd5e1 1px, transparent 1px)","background-size":"32px 32px"}},null,-1)),e[15]||(e[15]=l("div",{class:"absolute top-0 right-[-10%] w-[500px] h-[500px] bg-orange-300 rounded-full mix-blend-multiply filter blur-[128px] opacity-40 animate-blob"},null,-1)),e[16]||(e[16]=l("div",{class:"absolute bottom-[-10%] left-[-10%] w-[500px] h-[500px] bg-amber-300 rounded-full mix-blend-multiply filter blur-[128px] opacity-40 animate-blob animation-delay-2000"},null,-1)),e[17]||(e[17]=l("div",{class:"absolute bottom-[20%] right-[20%] w-[400px] h-[400px] bg-yellow-200 rounded-full mix-blend-multiply filter blur-[128px] opacity-40 animate-blob animation-delay-4000"},null,-1)),l("div",Z,[l("div",ee,[S(o,{to:"/",class:"text-sm font-medium text-slate-500 hover:text-orange-600 mb-4 inline-flex items-center gap-1 transition-colors"},{default:N(()=>[...e[1]||(e[1]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"m15 18-6-6 6-6"})],-1),_(" è¿”å›é¦–é¡µ ",-1)])]),_:1}),e[2]||(e[2]=l("h1",{class:"text-3xl md:text-4xl font-extrabold text-slate-900 mb-3"},[l("span",{class:"text-transparent bg-clip-text bg-gradient-to-r from-orange-500 to-amber-500"},"éšç§æ¶‚æŠ¹å«å£«")],-1)),e[3]||(e[3]=l("p",{class:"text-slate-600 max-w-2xl"}," çº¯æœ¬åœ°å®‰å…¨å¤„ç†ã€‚æ”¯æŒé«˜æ–¯æ¨¡ç³Šã€é©¬èµ›å…‹ã€çº¯è‰²è¦†ç›–ï¼Œå†…ç½® AI è‡ªåŠ¨è¯†åˆ«æ–‡æœ¬åŒºåŸŸã€‚ ",-1))]),l("div",te,[l("div",le,[l("div",ae,[r.value?(p(),g("div",se,[e[4]||(e[4]=l("div",{class:"absolute inset-0 z-0 opacity-50",style:{"background-position":"0 0, 0 10px, 10px -10px, -10px 0","background-size":"20px 20px","background-image":"linear-gradient(45deg, #cbd5e1 25%, transparent 25%), linear-gradient(-45deg, #cbd5e1 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #cbd5e1 75%), linear-gradient(-45deg, transparent 75%, #cbd5e1 75%)"}},null,-1)),l("canvas",{ref_key:"canvasRef",ref:u,onMousedown:F,onMousemove:P,onMouseup:R,onMouseleave:R,class:"relative z-10 max-w-full max-h-[70vh] shadow-lg object-contain"},null,544),e[5]||(e[5]=l("div",{class:"absolute top-4 left-1/2 -translate-x-1/2 bg-black/70 backdrop-blur text-white px-4 py-1.5 rounded-full text-xs font-medium pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity"}," ğŸ–±ï¸ é¼ æ ‡æ¡†é€‰åŒºåŸŸä»¥æ‰“ç  ",-1))])):(p(),g("div",oe,[S(H,{accept:"image/*",hint:"æ‹–å…¥æˆªå›¾æˆ–ç‚¹å‡»ä¸Šä¼  (JPG, PNG, WebP)",onFilesSelected:z})])),r.value?(p(),g("div",ne,[l("button",{onClick:V,class:"p-2 hover:bg-slate-100 rounded-xl text-slate-600 tooltip",title:"æ’¤é”€ä¸Šä¸€æ­¥"},[...e[6]||(e[6]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M3 7v6h6"}),l("path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})],-1)])]),e[9]||(e[9]=l("div",{class:"w-px h-6 bg-slate-200 mx-1"},null,-1)),l("button",{onClick:A,class:"p-2 hover:bg-red-50 text-slate-600 hover:text-red-500 rounded-xl transition-colors",title:"æ¸…é™¤æ‰€æœ‰"},[...e[7]||(e[7]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[l("path",{d:"M3 6h18"}),l("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),l("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})],-1)])]),l("button",{onClick:B,class:"p-2 hover:bg-slate-100 text-slate-600 rounded-xl",title:"é‡æ–°ä¸Šä¼ "},[...e[8]||(e[8]=[l("span",{class:"text-xs font-bold"},"é‡é€‰",-1)])])])):I("",!0)])]),l("div",re,[l("div",ie,[e[11]||(e[11]=l("h2",{class:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2"},[l("span",{class:"w-1 h-6 bg-orange-500 rounded-full"}),_(" æ‰“ç æ ·å¼ ")],-1)),l("div",de,[(p(),g(X,null,Y(j,a=>l("button",{key:a.value,onClick:i=>v.value=a.value,class:q(["flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all gap-2",v.value===a.value?"border-orange-500 bg-orange-50 text-orange-700":"border-transparent bg-slate-100 text-slate-600 hover:bg-slate-200"])},[l("span",ce,y(a.icon),1),l("span",ge,y(a.label),1)],10,ue)),64))]),v.value!=="solid"?(p(),g("div",pe,[l("div",ve,[e[10]||(e[10]=l("label",{class:"text-xs font-bold text-slate-500 uppercase tracking-wider"},"å¼ºåº¦ / æ¨¡ç³Šåº¦",-1)),l("span",be,y(f.value),1)]),$(l("input",{type:"range","onUpdate:modelValue":e[0]||(e[0]=a=>f.value=a),min:v.value==="pixelate"?5:2,max:v.value==="pixelate"?50:30,step:"1",class:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-orange-500"},null,8,xe),[[G,f.value,void 0,{number:!0}]])])):I("",!0),e[12]||(e[12]=l("p",{class:"text-xs text-slate-400"}," æç¤ºï¼šæ¡†é€‰åå®æ—¶ç”Ÿæ•ˆï¼Œå¯å åŠ ä½¿ç”¨ã€‚ ",-1))]),l("div",he,[e[13]||(e[13]=O('<div class="absolute top-0 right-0 w-20 h-20 bg-orange-400/10 rounded-full blur-2xl" data-v-de890c1b></div><h2 class="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2" data-v-de890c1b><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-orange-500" data-v-de890c1b><path d="M21 12a9 9 0 1 1-6.219-8.56" data-v-de890c1b></path></svg> AI æ™ºèƒ½è¯†åˆ« </h2><p class="text-sm text-slate-600 mb-4 leading-relaxed" data-v-de890c1b> åˆ©ç”¨æµè§ˆå™¨å†…ç½® OCR è‡ªåŠ¨æ£€æµ‹å›¾ç‰‡ä¸­çš„æ–‡å­—åŒºåŸŸå¹¶è‡ªåŠ¨æ‰“ç ã€‚ </p>',3)),l("button",{onClick:L,disabled:!r.value||w.value,class:"w-full py-3 bg-white border border-orange-200 text-orange-700 font-bold rounded-xl shadow-sm hover:shadow-md hover:bg-orange-50 transition-all flex items-center justify-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed"},[w.value?(p(),g("span",fe,"â³")):(p(),g("span",we,"âœ¨")),_(" "+y(w.value?"æ­£åœ¨åˆ†æå›¾ç‰‡...":"ä¸€é”®è‡ªåŠ¨æŠ¹é™¤æ–‡å­—"),1)],8,me)]),l("button",{onClick:T,disabled:!r.value,class:"w-full py-4 bg-gradient-to-r from-orange-500 to-amber-500 text-white font-bold rounded-2xl shadow-lg shadow-orange-500/30 hover:shadow-orange-500/50 hover:-translate-y-1 transition-all disabled:opacity-50 disabled:shadow-none disabled:translate-y-0"}," ä¿å­˜å¤„ç†åçš„å›¾ç‰‡ ",8,ye)])])])])}}},Be=K(ke,[["__scopeId","data-v-de890c1b"]]);export{Be as default};
