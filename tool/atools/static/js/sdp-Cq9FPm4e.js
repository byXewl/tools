import{g as b}from"./file-saver-D_h_-nX0.js";function P(m,s){for(var e=0;e<s.length;e++){const t=s[e];if(typeof t!="string"&&!Array.isArray(t)){for(const r in t)if(r!=="default"&&!(r in m)){const n=Object.getOwnPropertyDescriptor(t,r);n&&Object.defineProperty(m,r,n.get?n:{enumerable:!0,get:()=>t[r]})}}}return Object.freeze(Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}))}var h={exports:{}},g;function x(){return g||(g=1,(function(m){const s={};s.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},s.localCName=s.generateIdentifier(),s.splitLines=function(e){return e.trim().split(`
`).map(t=>t.trim())},s.splitSections=function(e){return e.split(`
m=`).map((r,n)=>(n>0?"m="+r:r).trim()+`\r
`)},s.getDescription=function(e){const t=s.splitSections(e);return t&&t[0]},s.getMediaSections=function(e){const t=s.splitSections(e);return t.shift(),t},s.matchPrefix=function(e,t){return s.splitLines(e).filter(r=>r.indexOf(t)===0)},s.parseCandidate=function(e){let t;e.indexOf("a=candidate:")===0?t=e.substring(12).split(" "):t=e.substring(10).split(" ");const r={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]===void 0&&(r[t[n]]=t[n+1]);break}return r},s.writeCandidate=function(e){const t=[];t.push(e.foundation);const r=e.component;r==="rtp"?t.push(1):r==="rtcp"?t.push(2):t.push(r),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const n=e.type;return t.push("typ"),t.push(n),n!=="host"&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&e.protocol.toLowerCase()==="tcp"&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},s.parseIceOptions=function(e){return e.substring(14).split(" ")},s.parseRtpMap=function(e){let t=e.substring(9).split(" ");const r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=t.length===3?parseInt(t[2],10):1,r.numChannels=r.channels,r},s.writeRtpMap=function(e){let t=e.payloadType;e.preferredPayloadType!==void 0&&(t=e.preferredPayloadType);const r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(r!==1?"/"+r:"")+`\r
`},s.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},s.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&e.direction!=="sendrecv"?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+`\r
`},s.parseFmtp=function(e){const t={};let r;const n=e.substring(e.indexOf(" ")+1).split(";");for(let i=0;i<n.length;i++)r=n[i].trim().split("="),t[r[0].trim()]=r[1];return t},s.writeFmtp=function(e){let t="",r=e.payloadType;if(e.preferredPayloadType!==void 0&&(r=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const n=[];Object.keys(e.parameters).forEach(i=>{e.parameters[i]!==void 0?n.push(i+"="+e.parameters[i]):n.push(i)}),t+="a=fmtp:"+r+" "+n.join(";")+`\r
`}return t},s.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},s.writeRtcpFb=function(e){let t="",r=e.payloadType;return e.preferredPayloadType!==void 0&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(n=>{t+="a=rtcp-fb:"+r+" "+n.type+(n.parameter&&n.parameter.length?" "+n.parameter:"")+`\r
`}),t},s.parseSsrcMedia=function(e){const t=e.indexOf(" "),r={ssrc:parseInt(e.substring(7,t),10)},n=e.indexOf(":",t);return n>-1?(r.attribute=e.substring(t+1,n),r.value=e.substring(n+1)):r.attribute=e.substring(t+1),r},s.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(r=>parseInt(r,10))}},s.getMid=function(e){const t=s.matchPrefix(e,"a=mid:")[0];if(t)return t.substring(6)},s.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},s.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:s.matchPrefix(e+t,"a=fingerprint:").map(s.parseFingerprint)}},s.writeDtlsParameters=function(e,t){let r="a=setup:"+t+`\r
`;return e.fingerprints.forEach(n=>{r+="a=fingerprint:"+n.algorithm+" "+n.value+`\r
`}),r},s.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},s.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+(typeof e.keyParams=="object"?s.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+`\r
`},s.parseCryptoKeyParams=function(e){if(e.indexOf("inline:")!==0)return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},s.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},s.getCryptoParameters=function(e,t){return s.matchPrefix(e+t,"a=crypto:").map(s.parseCryptoLine)},s.getIceParameters=function(e,t){const r=s.matchPrefix(e+t,"a=ice-ufrag:")[0],n=s.matchPrefix(e+t,"a=ice-pwd:")[0];return r&&n?{usernameFragment:r.substring(12),password:n.substring(10)}:null},s.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+`\r
a=ice-pwd:`+e.password+`\r
`;return e.iceLite&&(t+=`a=ice-lite\r
`),t},s.parseRtpParameters=function(e){const t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=s.splitLines(e)[0].split(" ");t.profile=n[2];for(let p=3;p<n.length;p++){const a=n[p],f=s.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(f){const o=s.parseRtpMap(f),c=s.matchPrefix(e,"a=fmtp:"+a+" ");switch(o.parameters=c.length?s.parseFmtp(c[0]):{},o.rtcpFeedback=s.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(s.parseRtcpFb),t.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(o.name.toUpperCase());break}}}s.matchPrefix(e,"a=extmap:").forEach(p=>{t.headerExtensions.push(s.parseExtmap(p))});const i=s.matchPrefix(e,"a=rtcp-fb:* ").map(s.parseRtcpFb);return t.codecs.forEach(p=>{i.forEach(a=>{p.rtcpFeedback.find(o=>o.type===a.type&&o.parameter===a.parameter)||p.rtcpFeedback.push(a)})}),t},s.writeRtpDescription=function(e,t){let r="";r+="m="+e+" ",r+=t.codecs.length>0?"9":"0",r+=" "+(t.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=t.codecs.map(i=>i.preferredPayloadType!==void 0?i.preferredPayloadType:i.payloadType).join(" ")+`\r
`,r+=`c=IN IP4 0.0.0.0\r
`,r+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,t.codecs.forEach(i=>{r+=s.writeRtpMap(i),r+=s.writeFmtp(i),r+=s.writeRtcpFb(i)});let n=0;return t.codecs.forEach(i=>{i.maxptime>n&&(n=i.maxptime)}),n>0&&(r+="a=maxptime:"+n+`\r
`),t.headerExtensions&&t.headerExtensions.forEach(i=>{r+=s.writeExtmap(i)}),r},s.parseRtpEncodingParameters=function(e){const t=[],r=s.parseRtpParameters(e),n=r.fecMechanisms.indexOf("RED")!==-1,i=r.fecMechanisms.indexOf("ULPFEC")!==-1,p=s.matchPrefix(e,"a=ssrc:").map(u=>s.parseSsrcMedia(u)).filter(u=>u.attribute==="cname"),a=p.length>0&&p[0].ssrc;let f;const o=s.matchPrefix(e,"a=ssrc-group:FID").map(u=>u.substring(17).split(" ").map(y=>parseInt(y,10)));o.length>0&&o[0].length>1&&o[0][0]===a&&(f=o[0][1]),r.codecs.forEach(u=>{if(u.name.toUpperCase()==="RTX"&&u.parameters.apt){let l={ssrc:a,codecPayloadType:parseInt(u.parameters.apt,10)};a&&f&&(l.rtx={ssrc:f}),t.push(l),n&&(l=JSON.parse(JSON.stringify(l)),l.fec={ssrc:a,mechanism:i?"red+ulpfec":"red"},t.push(l))}}),t.length===0&&a&&t.push({ssrc:a});let c=s.matchPrefix(e,"b=");return c.length&&(c[0].indexOf("b=TIAS:")===0?c=parseInt(c[0].substring(7),10):c[0].indexOf("b=AS:")===0?c=parseInt(c[0].substring(5),10)*1e3*.95-2e3*8:c=void 0,t.forEach(u=>{u.maxBitrate=c})),t},s.parseRtcpParameters=function(e){const t={},r=s.matchPrefix(e,"a=ssrc:").map(p=>s.parseSsrcMedia(p)).filter(p=>p.attribute==="cname")[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);const n=s.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=n.length>0,t.compound=n.length===0;const i=s.matchPrefix(e,"a=rtcp-mux");return t.mux=i.length>0,t},s.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+=`a=rtcp-rsize\r
`),e.mux&&(t+=`a=rtcp-mux\r
`),e.ssrc!==void 0&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+`\r
`),t},s.parseMsid=function(e){let t;const r=s.matchPrefix(e,"a=msid:");if(r.length===1)return t=r[0].substring(7).split(" "),{stream:t[0],track:t[1]};const n=s.matchPrefix(e,"a=ssrc:").map(i=>s.parseSsrcMedia(i)).filter(i=>i.attribute==="msid");if(n.length>0)return t=n[0].value.split(" "),{stream:t[0],track:t[1]}},s.parseSctpDescription=function(e){const t=s.parseMLine(e),r=s.matchPrefix(e,"a=max-message-size:");let n;r.length>0&&(n=parseInt(r[0].substring(19),10)),isNaN(n)&&(n=65536);const i=s.matchPrefix(e,"a=sctp-port:");if(i.length>0)return{port:parseInt(i[0].substring(12),10),protocol:t.fmt,maxMessageSize:n};const p=s.matchPrefix(e,"a=sctpmap:");if(p.length>0){const a=p[0].substring(10).split(" ");return{port:parseInt(a[0],10),protocol:a[1],maxMessageSize:n}}},s.writeSctpDescription=function(e,t){let r=[];return e.protocol!=="DTLS/SCTP"?r=["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+t.port+`\r
`]:r=["m="+e.kind+" 9 "+e.protocol+" "+t.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+t.port+" "+t.protocol+` 65535\r
`],t.maxMessageSize!==void 0&&r.push("a=max-message-size:"+t.maxMessageSize+`\r
`),r.join("")},s.generateSessionId=function(){return Math.random().toString().substr(2,22)},s.writeSessionBoilerplate=function(e,t,r){let n;const i=t!==void 0?t:2;return e?n=e:n=s.generateSessionId(),`v=0\r
o=`+(r||"thisisadapterortc")+" "+n+" "+i+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},s.getDirection=function(e,t){const r=s.splitLines(e);for(let n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substring(2)}return t?s.getDirection(t):"sendrecv"},s.getKind=function(e){return s.splitLines(e)[0].split(" ")[0].substring(2)},s.isRejected=function(e){return e.split(" ",2)[1]==="0"},s.parseMLine=function(e){const r=s.splitLines(e)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},s.parseOLine=function(e){const r=s.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},s.isValidSDP=function(e){if(typeof e!="string"||e.length===0)return!1;const t=s.splitLines(e);for(let r=0;r<t.length;r++)if(t[r].length<2||t[r].charAt(1)!=="=")return!1;return!0},m.exports=s})(h)),h.exports}var d=x();const I=b(d),S=P({__proto__:null,default:I},[d]);export{I as S,S as s};
