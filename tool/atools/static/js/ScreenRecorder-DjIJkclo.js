import{R as B,l as d,y as t,q as I,J as O,C as b,A as M,Q as z,I as N,P as $,H as w,F as E,b as v,K as F,v as c}from"./@vue-CpAqE2Pn.js";import{f as P}from"./fix-webm-duration-ttdzgk4r.js";import{_ as q}from"./plugin-vueexport-helper-DlAUqK2U.js";import"./file-saver-D_h_-nX0.js";const G={class:"min-h-screen bg-slate-50 relative overflow-hidden font-sans selection:bg-rose-100"},H={class:"relative z-10 max-w-6xl mx-auto px-4 sm:px-6 py-10 flex flex-col min-h-screen"},J={class:"text-center mb-8"},K={class:"flex-1 flex flex-col gap-6"},Q={class:"flex-1 bg-black/90 rounded-3xl shadow-2xl overflow-hidden relative group border border-slate-800 min-h-[400px] flex items-center justify-center backdrop-blur-sm"},W={key:1,class:"absolute top-6 right-6 flex items-center gap-2 bg-black/60 backdrop-blur px-4 py-2 rounded-full border border-white/10 z-20"},X={class:"text-white font-mono font-bold"},Y=["src"],Z={class:"bg-white/80 backdrop-blur-xl rounded-2xl p-4 shadow-xl border border-white/50 flex flex-col md:flex-row justify-between items-center gap-4"},ee={class:"flex items-center gap-6"},te={class:"flex items-center gap-2 cursor-pointer select-none group"},oe={class:"relative"},re=["disabled"],se={class:"flex items-center gap-3"},le={__name:"ScreenRecorder",setup(ae){const r=v("idle"),h=v(!1),m=v(0),f=v(null),l=v("");let a=null,x=[],k=null,n=null,i=null,y=[];const _=async()=>{try{const o=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:!0});i=new(window.AudioContext||window.webkitAudioContext);const e=i.createMediaStreamDestination();if(y=[],o.getAudioTracks().length>0){const s=i.createMediaStreamSource(o);s.connect(e),y.push(s)}if(h.value)try{const s=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),g=i.createMediaStreamSource(s);g.connect(e),y.push(g)}catch(s){console.warn("éº¦å…‹é£è·å–å¤±è´¥",s),alert("éº¦å…‹é£æƒé™è¢«æ‹’ç»ï¼Œå°†åªå½•åˆ¶å±å¹•éŸ³é¢‘ã€‚")}const u=e.stream.getAudioTracks(),p=o.getVideoTracks();u.length>0?n=new MediaStream([...p,...u]):n=new MediaStream([...p]),o.getVideoTracks()[0].onended=()=>{C()},f.value&&(f.value.srcObject=n);const R=T();a=new MediaRecorder(n,{mimeType:R}),x=[],a.ondataavailable=s=>{s.data.size>0&&x.push(s.data)},a.onstop=async()=>{const s=new Blob(x,{type:R}),g=m.value*1e3;P(s,g,A=>{l.value=URL.createObjectURL(A),r.value="finished"}),S()},a.start(1e3),r.value="recording",V()}catch(o){console.error("å½•åˆ¶å¯åŠ¨å¤±è´¥",o),S()}},C=()=>{a&&a.state!=="inactive"&&a.stop()},S=()=>{D(),n&&(n.getTracks().forEach(o=>o.stop()),n=null),i&&(i.close(),i=null),f.value&&(f.value.srcObject=null)},T=()=>["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/webm"].find(e=>MediaRecorder.isTypeSupported(e))||"",j=()=>{if(!l.value)return;const o=document.createElement("a");o.href=l.value,o.download=`record_${new Date().toISOString().slice(0,19).replace(/[:T]/g,"-")}.webm`,document.body.appendChild(o),o.click(),document.body.removeChild(o)},U=()=>{l.value&&URL.revokeObjectURL(l.value),r.value="idle",l.value="",m.value=0,x=[]},V=()=>{m.value=0,k=setInterval(()=>{m.value++},1e3)},D=()=>{k&&clearInterval(k)},L=o=>{const e=Math.floor(o/3600),u=Math.floor(o%3600/60),p=o%60;return`${e.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}`};return B(()=>{S(),l.value&&URL.revokeObjectURL(l.value)}),(o,e)=>{const u=F("RouterLink");return c(),d("div",G,[e[10]||(e[10]=t("div",{class:"absolute inset-0 z-0 opacity-[0.4]",style:{"background-image":"radial-gradient(#cbd5e1 1px, transparent 1px)","background-size":"32px 32px"}},null,-1)),e[11]||(e[11]=t("div",{class:"absolute top-[-10%] left-[-10%] w-[500px] h-[500px] bg-rose-300 rounded-full mix-blend-multiply filter blur-[128px] opacity-40 animate-blob"},null,-1)),e[12]||(e[12]=t("div",{class:"absolute bottom-[-10%] right-[-10%] w-[500px] h-[500px] bg-purple-300 rounded-full mix-blend-multiply filter blur-[128px] opacity-40 animate-blob animation-delay-2000"},null,-1)),e[13]||(e[13]=t("div",{class:"absolute top-[30%] left-[20%] w-[400px] h-[400px] bg-pink-300 rounded-full mix-blend-multiply filter blur-[100px] opacity-30 animate-blob animation-delay-4000"},null,-1)),t("div",H,[t("div",J,[I(u,{to:"/",class:"inline-flex items-center gap-1 text-sm font-medium text-slate-500 hover:text-rose-600 mb-4 transition-colors"},{default:O(()=>[...e[1]||(e[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"m15 18-6-6 6-6"})],-1),w(" è¿”å›é¦–é¡µ ",-1)])]),_:1}),e[2]||(e[2]=t("h1",{class:"text-4xl md:text-5xl font-extrabold text-slate-900 mb-4"},[t("span",{class:"text-transparent bg-clip-text bg-gradient-to-r from-rose-500 to-pink-600"},"æç®€å±å¹•å½•åˆ¶ Pro")],-1)),e[3]||(e[3]=t("p",{class:"text-slate-600 max-w-2xl mx-auto"}," æ··éŸ³å¼•æ“å‡çº§ï¼šå®Œç¾æ”¯æŒç³»ç»ŸéŸ³+éº¦å…‹é£ã€‚è§†é¢‘è‡ªå¸¦æ—¶é—´æˆ³ç´¢å¼•ï¼Œæ”¯æŒæ‹–æ‹½è¿›åº¦æ¡ã€‚ ",-1))]),t("div",K,[t("div",Q,[r.value==="idle"?(c(),d("div",{key:0,class:"text-center p-10 cursor-pointer hover:scale-105 transition-transform duration-300",onClick:_},[...e[4]||(e[4]=[t("div",{class:"w-24 h-24 rounded-full bg-slate-800 border-2 border-slate-700 flex items-center justify-center mx-auto mb-6 group-hover:border-rose-500 transition-colors"},[t("div",{class:"w-16 h-16 rounded-full bg-rose-500 shadow-[0_0_30px_rgba(244,63,94,0.5)]"})],-1),t("h3",{class:"text-white text-xl font-bold mb-2"}," ç‚¹å‡»å¼€å§‹å½•åˆ¶ ",-1),t("p",{class:"text-slate-400 text-sm"}," æ”¯æŒ å±å¹• / çª—å£ / æ ‡ç­¾é¡µ ",-1)])])):b("",!0),M(t("video",{ref_key:"previewVideoRef",ref:f,class:"w-full h-full object-contain bg-black",autoplay:"",muted:"",playsinline:""},null,512),[[z,r.value==="recording"||r.value==="preview"]]),r.value==="recording"?(c(),d("div",W,[e[5]||(e[5]=t("div",{class:"w-3 h-3 rounded-full bg-red-500 animate-pulse"},null,-1)),t("span",X,N(L(m.value)),1)])):b("",!0),r.value==="finished"?(c(),d("video",{key:2,src:l.value,controls:"",class:"w-full h-full object-contain bg-black"},null,8,Y)):b("",!0)]),t("div",Z,[t("div",ee,[t("label",te,[t("div",oe,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=p=>h.value=p),disabled:r.value==="recording",class:"sr-only peer"},null,8,re),[[$,h.value]]),e[6]||(e[6]=t("div",{class:"w-10 h-6 bg-slate-200 rounded-full peer peer-checked:bg-rose-500 peer-focus:ring-2 peer-focus:ring-rose-300 transition-all after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full peer-checked:after:border-white"},null,-1))]),e[7]||(e[7]=t("span",{class:"text-sm font-medium text-slate-700 group-hover:text-rose-600 transition-colors flex items-center gap-1"}," ğŸ¤ éº¦å…‹é£æ··éŸ³ ",-1))]),e[8]||(e[8]=t("div",{class:"text-xs text-slate-400 hidden md:block border-l border-slate-300 pl-4"},[w(" æ³¨æ„ï¼šè¯·åœ¨å¼¹çª—ä¸­å‹¾é€‰ "),t("strong",null,'"åˆ†äº«éŸ³é¢‘"'),w(" ä»¥å½•åˆ¶ç³»ç»Ÿå£°éŸ³ ")],-1))]),t("div",se,[r.value==="idle"?(c(),d("button",{key:0,onClick:_,class:"btn-primary bg-rose-500 hover:bg-rose-600 shadow-rose-500/30"}," å¼€å§‹å½•åˆ¶ ")):b("",!0),r.value==="recording"?(c(),d("button",{key:1,onClick:C,class:"btn-danger"},[...e[9]||(e[9]=[t("span",{class:"w-3 h-3 bg-white rounded-sm"},null,-1),w(" ç»“æŸå½•åˆ¶ ",-1)])])):b("",!0),r.value==="finished"?(c(),d(E,{key:2},[t("button",{onClick:U,class:"btn-secondary"}," ä¸¢å¼ƒ "),t("button",{onClick:j,class:"btn-primary bg-gradient-to-r from-rose-500 to-pink-500 hover:from-rose-600 hover:to-pink-600 shadow-pink-500/30"}," ğŸ’¾ ä¸‹è½½ ")],64)):b("",!0)])])])])])}}},ue=q(le,[["__scopeId","data-v-181e7164"]]);export{ue as default};
